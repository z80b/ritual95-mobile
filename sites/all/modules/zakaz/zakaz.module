<?php //$Id: zakaz.info,v 1.0 2011/04/19 18:20:21 z80b Exp $

require_once 'mail.inc';

function zakaz_init() {
    drupal_add_css(drupal_get_path('module', 'zakaz') . '/zakaz.css');
}

function zakaz_menu() {
    return array (
        'order' => array (
            'title' => 'Сделать заказ',
 	    'page callback'    => 'drupal_get_form',
            'page arguments'   => array('zakaz_form'),
	    'access arguments' => array ('access content'),
	    'type'             => MENU_CALLBACK,
        ),
    );
}

function zakaz_form() {
    return array (
        '#attributes' => array (
            'enctype' => 'multipart/form-data',
        ),
        'form_fieldset' => array (
            '#type' => 'fieldset',
            'name' => array (
                '#type'     => 'textfield',
                '#required' => true,
                '#title'    => 'Представьтесь пожалуйста',
            ),
            'hphone' => array (
                '#type'  => 'textfield',
                '#title' => 'Домашний телефон',
            ),
            'mphone' => array (
                '#type'     => 'textfield',
                '#required' => true,
                '#title'    => 'Мобильный телефон',
            ),
            'email' => array (
                '#type'  => 'textfield',
                '#title' => 'E-mail заказчика',
            ),
            'addres' => array (
                '#type' => 'textfield',
                '#title' => 'Адрес заказчика',

            ),
            'other_parems' => array (
                '#type'  => 'fieldset',
                '#title' => 'Более подробно о заказе',
                '#description' => '',
                '#collapsible' => true,
                '#collapsed'   => true,
                'place' => array (
                    '#type'    => 'select',
                    '#title'   => 'Укажите ниже',
                    '#options' => array (
                        'Место установки памятника',
                        'Я сам заберу памятник',
                    ),
                ),
                'place_addres' => array (
                    '#type'  => 'textfield',
                    '#title' => 'Адрес установки',
                ),
                'deadman_field' => array (
                    '#type'  => 'fieldset',
                    '#title' => 'Данные покойного',
                    'name1' => array (
                        '#type'  => 'textfield',
                        '#title' => 'Ф.И.О. покойного',
                    ),
                    'photo1' => array (
                        '#type'  => 'file',
                        '#title' => 'Загрузите портрет',
                        '#description' => 'Внимание! Загружайте фото не более 2 Mb.',
                    ),
                    'birthday1' => array (
                        '#type'  => 'textfield',
                        '#title' => 'Дата рождения'
                    ),
                    'deadday1' => array (
                        '#type'  => 'textfield',
                        '#title' => 'Дата смерти',
                    ),
                ),
                'deadman_field2' => array (
                    '#type'  => 'fieldset',
                    '#title' => 'Возможно Вам нужен памятник с двумя портретами и надписями?',
                    '#description' => ' Тогда заполните данные на второго покойного',
                    '#collapsible' => true,
                    '#collapsed'   => true,
                    'name2' => array (
                        '#type'  => 'textfield',
                        '#title' => 'Ф.И.О. покойного',
                    ),
                    'photo2' => array (
                        '#type'  => 'file',
                        '#title' => 'Загрузите портрет',
                        '#description' => 'Внимание! Загружайте фото не более 2 Mb.',
                    ),
                    'birthday2' => array (
                        '#type'  => 'textfield',
                        '#title' => 'Дата рождения'
                    ),
                    'deadday2' => array (
                        '#type'  => 'textfield',
                        '#title' => 'Дата смерти',
                    ),
                ),
                'pamjatnik' => array (
                    '#type'  => 'fieldset',
                    '#title' => 'Ниже обязательно выберите тип и параметры памятника!',
                    'form' => array (
                        '#type'  => 'select',
                        '#title' => 'Тип памятника',
                        '#options' => array (
                                                    '--' => '--',
                            '№1 Парус укороченный' => '№1 Парус укороченный',
                            '№2 Прямой укороченный' => '№2 Прямой укороченный',
                            '№3 Волна укороченная' => '№3 Волна укороченная',
                            '№4 Полуарочная укороченная' => '№4 Полуарочная укороченная',
                            '№5 Парус округлый укороченный' => '№5 Парус округлый укороченный',
                            '№6 Волна округлая укороченная' => '№6 Волна округлая укороченная',
                            '№7 Прямой' => '№7 Прямой',
                            '№8 Парус' => '№8 Парус',
                            '№9 Волна на прямой' => '№9 Волна на прямой',
                            '№10 Полуарочный' => '№10 Полуарочный',
                            '№11 Волна' => '№11 Волна',
                            '№12 Полуарочный с плечиками' => '№12 Полуарочный с плечиками',
                            '№13 Округлый с плечиками' => '№13 Округлый с плечиками',
                            '№14 Парус округлый' => '№14 Парус округлый',
                            '№15 Волна округлая' => '№15 Волна округлая',
                            '№16 Капля' => '№16 Капля',
                            '№17 Пламя' => '№17 Пламя',
                            '№18 Листок' => '№18 Листок',
                            '№19 Свеча с фигурным крестом' => '№19 Свеча с фигурным крестом',
                            '№20 Тюльпан' => '№20 Тюльпан',
                            '№21 Лебедь' => '№21 Лебедь',
                            '№22 Ппрямой с плечиками' => '№22 Ппрямой с плечиками',
                            '№23 Купол зауженный' => '№23 Купол зауженный',
                            '№24 Зауженный без углов' => '№24 Зауженный без углов',
                            '№25 Звезда' => '№25 Звезда',
                            '№26 Скорбящая мать' => '№26 Скорбящая мать',
                            '№27 Прямой без углов' => '№27 Прямой без углов',
                            '№28 Крест на прямой со скосом' => '№28 Крест на прямой со скосом',
                            '№29 Объемный крест на волне' => '№29 Объемный крест на волне',
                            '№30 Крест шестиконечный' => '№30 Крест шестиконечный',
                            '№31 Крест восьмиконечный православный' => '№31 Крест восьмиконечный православный',
                            '№32 Крест большой H-125см. на трапеции' => '№32 Крест большой H-125см. на трапеции',
                            '№33 Купол с  шестиконечным крестом' => '№33 Купол с  шестиконечным крестом',
                            '№34 Готика с четырехконечным крестом' => '№34 Готика с четырехконечным крестом',
                            '№35 Крест большой H-125см. на прямой с плечиками' => '№35 Крест большой H-125см. на прямой с плечиками',
                            '№36 Телевизор трапеция' => '№36 Телевизор трапеция',
                            '№37 Телевизор прямой' => '№37 Телевизор прямой',
                            '№38 Телевизор верх волна' => '№38 Телевизор верх волна',
                            '№39 Объемный крест на телевизоре' => '№39 Объемный крест на телевизоре',
                            '№40 Телевизор полуарочный' => '№40 Телевизор полуарочный',
                            '№41 Телевизор флаг' => '№41 Телевизор флаг',
                            '№42 Сердце' => '№42 Сердце',
                            '№43 Равносторонний крест' => '№43 Равносторонний крест',
                            '№44 Телевизор специальной формы' => '№44 Телевизор специальной формы',
                            '№45 Воздушный крест со скосами' => '№45 Воздушный крест со скосами',
                            '№46 Воздушный крест' => '№46 Воздушный крест',
                            '№47 Сердце с воздушным крестом' => '№47 Сердце с воздушным крестом',
                            '№48 Книжка верх прямой' => '№48 Книжка верх прямой',
                            '№49 Книжка с сердцем' => '№49 Книжка с сердцем',
                            '№50 Книжка верх волна' => '№50 Книжка верх волна',
                            '№51 Комплекс' => '№51 Комплекс',
                            '№52 Комплекс' => '№52 Комплекс',
                            '№53 Комплекс' => '№53 Комплекс',
                            '№54 Комплекс' => '№54 Комплекс',
                            '№55 Комплекс' => '№55 Комплекс',
                            '№56 Комплекс' => '№56 Комплекс',
                            '№57 Комплекс' => '№57 Комплекс',
                            '№58 Комплекс' => '№58 Комплекс',
                            '№64,№65 Памятник цвет Малахит / Бордо' => '№64,№65 Памятник цвет Малахит / Бордо',
                            '№66,№67,№68 Доска в обрамлении (портрет и ФИО), Стол, Лавка' => '№66,№67,№68 Доска в обрамлении (портрет и ФИО), Стол, Лавка',
                            '№70 Цветочница открытая' => '№70 Цветочница открытая',
                            '№71 Цветочница закрытая' => '№71 Цветочница закрытая',
                            '№72 Цветочница с надгробием' => '№72 Цветочница с надгробием',
                            '№73 Цветочница открытая двойная' => '№73 Цветочница открытая двойная',
                            '№74 Цветочница закрытая двойная' => '№74 Цветочница закрытая двойная',
                            '№75 Цветочница с надгробием двойная' => '№75 Цветочница с надгробием двойная',
                        ),
                    ),

                    'cvetnik_form' => array (
                        '#type'    => 'select',
                        '#title'   => 'Форма цветника',
                        '#options' => array (
                                                    '--' => '--',
                            'Открытая 117 х 52 см.' => 'Открытая 117 х 52 см.',
                            'Закрытая 117 х 52 см.' => 'Закрытая 117 х 52 см.',
                            'С надгробием 117 х 52 см.' => 'С надгробием 117 х 52 см.',
                            'Двойная открытая 117 х 100 см.' => 'Двойная открытая 117 х 100 см.',
                            'Двойная закрытая 117 х 100 см.' => 'Двойная закрытая 117 х 100 см.',
                            'Двойная с надгробием 117 х 100 см.' => 'Двойная с надгробием 117 х 100 см.',
                            'Без цветника' => 'Без цветника',
                        ),
                    ),
                    'color' => array (
                        '#type'    => 'select',
                        '#title'   => 'Цвет памятника',
                        '#options' => array (
                                                    '--' => '--',
                            'Малахит' => 'Малахит',
                            'Бордо' => 'Бордо',
                            'Черный' => 'Черный',
                        ),
                    ),
                    'portret' => array (
                        '#type'    => 'radios',
                        '#title'   => 'Гравировать портрет',
                        '#options' => array (
                            'Нет' => 'Нет',
                            '1' => '1',
                            '2' => '2',
                            '3' => '3',
                            'Другое' => 'Другое',
                        ),
                    ),
                    'font_type' => array (
                        '#type'    => 'select',
                        '#title'   => 'Тип шрифта',
                        '#options' => array (
                                                    '--' => '--',
                            '№1' => '№1',
                            '№2' => '№2',
                            '№3' => '№3',
                            '№4' => '№4',
                            '№5' => '№5',
                            '№6' => '№6',
                            '№7' => '№7',
                            '№8' => '№8',
                            '№9' => '№9',
                            '№10' => '№10',
                            '№11' => '№11',
                            '№12' => '№12',
                            '№13' => '№13',
                            '№14' => '№14',
                        ),
                    ),
                    'cross' => array (
                        '#type'    => 'select',
                        '#title'   => 'Гравировать крест',
                        '#options' => array (
                                                    '--' => '--',
                            '№15' => '№15',
                            '№16' => '№16',
                            '№17' => '№17',
                            '№18' => '№18',
                            '№19' => '№19',
                            '№20' => '№20',
                            '№21' => '№21',
                            '№22' => '№22',
                            '№23' => '№23',
                        ),
                    ),
                    'vinjetki' => array (
                        '#type'        => 'textfield',
                        '#title'       => 'Гравировать виньетки',
                        '#description' => 'Например: (Геометрическая, вверху справа)',
                    ),
                    'flowers' => array (
                        '#type'    => 'radios',
                        '#title'   => 'Гравировать цветы',
                        '#options' => array (
                            'Не надо' => 'Не надо',
                            'Розы' => 'Розы',
                            'Гвоздики' => 'Гвоздики',
                            'Лилии' => 'Лилии',
                            'Тюльпаны' => 'Тюльпаны',
                            'Сирень' => 'Сирень',
                            'Другие' => 'Другие',
                        ),
                    ),
                    'epitafiya' => array (
                        '#type'        => 'select',
                        '#title'       => 'Эпитафия',
                        '#description' => 'Выберите эпитафию',
                        '#options' => array (
                            '--' => '--',
                            '1 Помним, любим, скорбим. ' => '1 Помним, любим, скорбим. ',
                            '2 Ты ушел из жизни слишком рано,Нашу боль не выразят слова.Спи, родной, ты наша боль и рана,Память о тебе всегда жива. ' => '2 Ты ушел из жизни слишком рано,Нашу боль не выразят слова.Спи, родной, ты наша боль и рана,Память о тебе всегда жива. ',
                            '3 Не высказать горя,Не выплакать слез,Ты радость навеки из дома унес. ' => '3 Не высказать горя,Не выплакать слез,Ты радость навеки из дома унес. ',
                            '4 Из жизни ты ушел мгновенно,А боль осталась навсегда. ' => '4 Из жизни ты ушел мгновенно,А боль осталась навсегда. ',
                            '5 Мы приходим сюда,Чтоб цветы положить.Очень трудно, родная,Без тебя нам прожить. ' => '5 Мы приходим сюда,Чтоб цветы положить.Очень трудно, родная,Без тебя нам прожить. ',
                            '6 Скорбь и печаль твоей утратыПребудут с нами навсегда.Что может быть страшней и горшеПотери мужа и отца. ' => '6 Скорбь и печаль твоей утратыПребудут с нами навсегда.Что может быть страшней и горшеПотери мужа и отца. ',
                            '7 И кончилась жизнь земная,Все силы угасли в тебе,Прощай же, родной наш, любимый,Вечная память тебе. ' => '7 И кончилась жизнь земная,Все силы угасли в тебе,Прощай же, родной наш, любимый,Вечная память тебе. ',
                            '8 Скорбь души не выплакать слезами,Сырой могиле горя не понять. ' => '8 Скорбь души не выплакать слезами,Сырой могиле горя не понять. ',
                            '9 Из жизни ты ушла непостижимо рано.Родителей печаль гнетет.В сердцах их кровоточит рана.Сынишка твой растет,Не зная слова «мама». ' => '9 Из жизни ты ушла непостижимо рано.Родителей печаль гнетет.В сердцах их кровоточит рана.Сынишка твой растет,Не зная слова «мама». ',
                            '10 Не найти нам слов описать наше горе.Не найти в мире силы,Чтоб тебя подняла.Наших слов не вместит даже море,Как жестока судьба, что тебя отняла. ' => '10 Не найти нам слов описать наше горе.Не найти в мире силы,Чтоб тебя подняла.Наших слов не вместит даже море,Как жестока судьба, что тебя отняла. ',
                            '11 Как жаль, что твоя жизньБыла такой короткой,Но вечной будет память о тебе. ' => '11 Как жаль, что твоя жизньБыла такой короткой,Но вечной будет память о тебе. ',
                            '12 Ты ушел из жизни,А из сердца - нет. ' => '12 Ты ушел из жизни,А из сердца - нет. ',
                            '13 К твоей безвременной могилеНаша тропа не зарастет.Родной твой образ, образ милыйВсегда сюда нас приведет, ' => '13 К твоей безвременной могилеНаша тропа не зарастет.Родной твой образ, образ милыйВсегда сюда нас приведет, ',
                            '14 Тому, кто дорог был при жизни.От тех, кто любит и скорбит. ' => '14 Тому, кто дорог был при жизни.От тех, кто любит и скорбит. ',
                            '15 Словами не высказать,Слезами не выплакать наше горе.Ты всегда в наших сердцах. ' => '15 Словами не высказать,Слезами не выплакать наше горе.Ты всегда в наших сердцах. ',
                            '16 Ты зачем ушел, родной,Спать в земле сырой?Ты зачем меня оставил маяться одной? ' => '16 Ты зачем ушел, родной,Спать в земле сырой?Ты зачем меня оставил маяться одной? ',
                            '17 Прости, что жизнь твою я не спасла.Весь век не будет мне покоя.Не хватит сил, не хватит слез,Чтобы измерить мое горе. ' => '17 Прости, что жизнь твою я не спасла.Весь век не будет мне покоя.Не хватит сил, не хватит слез,Чтобы измерить мое горе. ',
                            '18 Сердце погасло, будто зарница,Боль не притушат года.Образ твой вечно будет хранитьсяВ памяти нашей всегда. ' => '18 Сердце погасло, будто зарница,Боль не притушат года.Образ твой вечно будет хранитьсяВ памяти нашей всегда. ',
                            '19 Спи спокойно, наш дорогой сын (отец). 	  ' => '19 Спи спокойно, наш дорогой сын (отец). 	  ',
                            '20 Как трудно подобрать слова,Чтоб ими нашу боль измерить.Не можем в смерть твою поверить,Ты с нами будешь навсегда. 	  ' => '20 Как трудно подобрать слова,Чтоб ими нашу боль измерить.Не можем в смерть твою поверить,Ты с нами будешь навсегда. 	  ',
                            '21 Мы все отдали быКусочек сердца своего,Лишь вновь забилось бы твое. 	  ' => '21 Мы все отдали быКусочек сердца своего,Лишь вновь забилось бы твое. 	  ',
                            '22 Вы, листочки, не шумите,Нашу маму не будите. 	  ' => '22 Вы, листочки, не шумите,Нашу маму не будите. 	  ',
                            '23 Ты нас покинула, родная.Настал разлуки скорбный час.Но все по-прежнему живаяТы в нашем сердце среди нас. 	  ' => '23 Ты нас покинула, родная.Настал разлуки скорбный час.Но все по-прежнему живаяТы в нашем сердце среди нас. 	  ',
                            '24 Не в силах горя превозмочь,Утраты боль нести,Никто не смог тебе помочь,Прости нас, (имя), прости. 	  ' => '24 Не в силах горя превозмочь,Утраты боль нести,Никто не смог тебе помочь,Прости нас, (имя), прости. 	  ',
                            '25 Любовь к тебе, родной сынок,Умрет лишь вместе с нами.И нашу боль и нашу скорбьНе выразить словами. 	  ' => '25 Любовь к тебе, родной сынок,Умрет лишь вместе с нами.И нашу боль и нашу скорбьНе выразить словами. 	  ',
                            '26 Не выразить словами всей скорби ипечали.В сердцах и памяти всегда ты с нами. 	  ' => '26 Не выразить словами всей скорби ипечали.В сердцах и памяти всегда ты с нами. 	  ',
                            '27 Прости, что мы свою любовь отдатьТебе при жизни не решились,Ты нам простил,От нас ушел,Мы -должниками вечными остались. 	  ' => '27 Прости, что мы свою любовь отдатьТебе при жизни не решились,Ты нам простил,От нас ушел,Мы -должниками вечными остались. 	  ',
                            '28 Склонившись, стоим над твоею могилой,Горячей слезой поливая цветы.Не хочется верить,Сын (отец) наш любимый,Что в этой могиле находишься ты. 	  ' => '28 Склонившись, стоим над твоею могилой,Горячей слезой поливая цветы.Не хочется верить,Сын (отец) наш любимый,Что в этой могиле находишься ты. 	  ',
                            '29 Спи, доченька любимая, спокойно.Ты свой короткий путь прошлаЧестно и радостно. 	  ' => '29 Спи, доченька любимая, спокойно.Ты свой короткий путь прошлаЧестно и радостно. 	  ',
                            '30 Нет больше горя,Чем горечь от утраты. 	  ' => '30 Нет больше горя,Чем горечь от утраты. 	  ',
                            '31 Никто не смог тебя спасти,Ушел из жизни очень рано,Но светлый образ твой роднойМы будем помнить постоянно. 	  ' => '31 Никто не смог тебя спасти,Ушел из жизни очень рано,Но светлый образ твой роднойМы будем помнить постоянно. 	  ',
                            '32 Нет таких слов, чтобы выразитьВсю боль и скорбь души нашей. 	  ' => '32 Нет таких слов, чтобы выразитьВсю боль и скорбь души нашей. 	  ',
                            '33 Живой тебя представить так легко,Что в смерть твоюПоверить невозможно. 	  ' => '33 Живой тебя представить так легко,Что в смерть твоюПоверить невозможно. 	  ',
                            '34 Он мудрецом не слылИ храбрецом не слыл.Но поклонись ему, он Человеком был. 	  ' => '34 Он мудрецом не слылИ храбрецом не слыл.Но поклонись ему, он Человеком был. 	  ',
                            '35 Слезами горя не утешишь,Тоске душевной нет конца,Любимый наш, ты вечно с нами,Мы помним образ твой всегда. 	  ' => '35 Слезами горя не утешишь,Тоске душевной нет конца,Любимый наш, ты вечно с нами,Мы помним образ твой всегда. 	  ',
                            '36 Ты жизнь свою прожил достойно,Оставив память нам навек.В безмолвном мире спи спокойно,Любимый нами человек. 	  ' => '36 Ты жизнь свою прожил достойно,Оставив память нам навек.В безмолвном мире спи спокойно,Любимый нами человек. 	  ',
                            '37 Светлая (Вечная) память о тебенавсегда останется в наших сердцах. ' => '37 Светлая (Вечная) память о тебенавсегда останется в наших сердцах. ',
                            '38 Спасибо за вместе прожитые годы... ' => '38 Спасибо за вместе прожитые годы... ',
                            '39 Тебя уж нет, а мы не верим.В душе у нас ты навсегда.И боль свою от той потериНе залечить нам никогда. ' => '39 Тебя уж нет, а мы не верим.В душе у нас ты навсегда.И боль свою от той потериНе залечить нам никогда. ',
                            '40 Ты жизнь любилИ многое хотел успеть.Но слишком рано оборвалась нить,Не дав тебе мечты осуществить. ' => '40 Ты жизнь любилИ многое хотел успеть.Но слишком рано оборвалась нить,Не дав тебе мечты осуществить. ',
                            '41 Горе нежданное, горе немерено,Самое дорогое в жизни потеряно.Жаль, что жизнь нельзя повторить,Чтобы тебе ее подарить. ' => '41 Горе нежданное, горе немерено,Самое дорогое в жизни потеряно.Жаль, что жизнь нельзя повторить,Чтобы тебе ее подарить. ',
                            '42 Нашу боль не измеритьИ в слезах не излить.Мы тебя, как живого,Будем вечно любить. ' => '42 Нашу боль не измеритьИ в слезах не излить.Мы тебя, как живого,Будем вечно любить. ',
                            '43 Мне тебя так не достаетдля полного человеческого счастья. ' => '43 Мне тебя так не достаетдля полного человеческого счастья. ',
                            '44 Тепло души твоейосталось вместе с нами. ' => '44 Тепло души твоейосталось вместе с нами. ',
                            '45 Все было в нем -Душа, талант и красота.Искрилось все для нас,Как светлая мечта. ' => '45 Все было в нем -Душа, талант и красота.Искрилось все для нас,Как светлая мечта. ',
                            '46 Светлый образ твойв памяти нашей. ' => '46 Светлый образ твойв памяти нашей. ',
                            '47 Ты рано ушел от нас,Наш любимый.Унес наше счастье и радость. ' => '47 Ты рано ушел от нас,Наш любимый.Унес наше счастье и радость. ',
                            '48 Трагедия тебя у нас забрала..Никто не смог тебя снасти.Какая боль, какая в сердце рана,Пока мы живы, с нами ты. ' => '48 Трагедия тебя у нас забрала..Никто не смог тебя снасти.Какая боль, какая в сердце рана,Пока мы живы, с нами ты. ',
                            '49 Как много нашего ушло с тобой,Как много твоего осталось с нами. ' => '49 Как много нашего ушло с тобой,Как много твоего осталось с нами. ',
                            '50 Не слышно голоса родного,Не видно добрых, милых глаз.Зачем судьба была жестока?Как рано ты ушел от нас. ' => '50 Не слышно голоса родного,Не видно добрых, милых глаз.Зачем судьба была жестока?Как рано ты ушел от нас. ',
                            '51 Я тебя взрастила, но не сберегла.А теперь могила сбережет тебя. ' => '51 Я тебя взрастила, но не сберегла.А теперь могила сбережет тебя. ',
                            '52 Тебе, единому, неповторимому,Склоняем головы свои. ' => '52 Тебе, единому, неповторимому,Склоняем головы свои. ',
                            '53 Спасибо за то, что ты жил. ' => '53 Спасибо за то, что ты жил. ',
                            '54 Любим тебя,и в памяти нашей всегда ты жива. ' => '54 Любим тебя,и в памяти нашей всегда ты жива. ',
                            '55 Как рано ты ушел, родной,оставив нам печаль и боль. 	  ' => '55 Как рано ты ушел, родной,оставив нам печаль и боль. 	  ',
                            '56 Опустела без тебя земля. 	  ' => '56 Опустела без тебя земля. 	  ',
                            '57 Ушел ты рано, не простившись,И не сказавши слова нам.Как жить нам дальше, убедившись,Что больше не вернешься к нам. 	  ' => '57 Ушел ты рано, не простившись,И не сказавши слова нам.Как жить нам дальше, убедившись,Что больше не вернешься к нам. 	  ',
                            '58 Вы меня не зовите,Я к вам не приду.Вы ко мне не спешите,Я вас подожду. 	  ' => '58 Вы меня не зовите,Я к вам не приду.Вы ко мне не спешите,Я вас подожду. 	  ',
                            '59 Тихо, деревья,Листвой не шумите.Мамочка спит,Вы ее не будите. 	  ' => '59 Тихо, деревья,Листвой не шумите.Мамочка спит,Вы ее не будите. 	  ',
                            '60 Прости, что нам под небом звезднымК твоей плите носить цветы.Прости, что нам остался воздух,Каким не надышался ты. 	  ' => '60 Прости, что нам под небом звезднымК твоей плите носить цветы.Прости, что нам остался воздух,Каким не надышался ты. 	  ',
                            '61 С любимыми не расстаются,лишь рядом быть перестают. 	  ' => '61 С любимыми не расстаются,лишь рядом быть перестают. 	  ',
                            '62 И сердцу больно,и горю нет конца. 	  ' => '62 И сердцу больно,и горю нет конца. 	  ',
                            '63 Великой скорби не измерить,Слезами горю не помочь.Тебя нет с нами, но навекиВ сердцах ты наших не умрешь. 	  ' => '63 Великой скорби не измерить,Слезами горю не помочь.Тебя нет с нами, но навекиВ сердцах ты наших не умрешь. 	  ',
                            '64 Вечная память о тебев сердцах родных. 	  ' => '64 Вечная память о тебев сердцах родных. 	  ',
                            '65 Любим тебя, гордимся тобой.В памяти нашейВсегда ты живой. 	  ' => '65 Любим тебя, гордимся тобой.В памяти нашейВсегда ты живой. 	  ',
                            '66 Как капли росы на розах,На щеках моих слезы.Спи спокойно, милый сын,Все тебя мы любим, помним и скорбим. 	  ' => '66 Как капли росы на розах,На щеках моих слезы.Спи спокойно, милый сын,Все тебя мы любим, помним и скорбим. 	  ',
                            '67 Любимый человек не умирает.Он просто с нами жить перестает. 	  ' => '67 Любимый человек не умирает.Он просто с нами жить перестает. 	  ',
                            '68 Подкралась злая смерть ко мне,Ушел от вас я навсегда.Ох как хотелось бы мне жить,Но такова моя судьба. 	  ' => '68 Подкралась злая смерть ко мне,Ушел от вас я навсегда.Ох как хотелось бы мне жить,Но такова моя судьба. 	  ',
                            '69 Господи, упокой душу раба твоегоИ сотвори ему Вечную Память. 	  ' => '69 Господи, упокой душу раба твоегоИ сотвори ему Вечную Память. 	  ',
                            '70 Одной звездой стало меньше на земле.Одной звездой стало больше на небе. 	  ' => '70 Одной звездой стало меньше на земле.Одной звездой стало больше на небе. 	  ',
                            '71 Ты всегда в памяти нашей. 	  ' => '71 Ты всегда в памяти нашей. 	  ',
                            '72 В сердцах людей оставив след,Память о тебе вечно жива. 	' => '72 В сердцах людей оставив след,Память о тебе вечно жива. 	',
                        ),
                    ),
                    'svecha' => array (
                        '#type'    => 'radios',
                        '#title'   => 'Гравировать свечу',
                        '#options' => array (
                            'Не надо' => 'Не надо',
                            'Одинарная' => 'Одинарная',
                            'Двойная' => 'Двойная',
                        ),
                    ),
                    'vaza' => array (
                        '#type'  => 'checkbox',
                        '#title' => 'Укомплектовать вазой'
                    ),
                    'more' => array (
                        '#type'    => 'radios',
                        '#title'   => 'Добавить к заказу',
                        '#options' => array (
                                                    '--' => '--',
                            'Лавочку' => 'Лавочку',
                            'Столик' => 'Столик',
                            'Лавочку и столик' => 'Лавочку и столик',
                            'Нет' => 'Нет',
                        ),
                    ),
                    'sposob' => array (
                        '#type'        => 'radios',
                        '#title'       => 'Способ нанесения графики',
                        '#description' => 'И портрет  может быть выполнен лазерной гравировкой, но в этом случае крайне желательна качественная  фотография',
                        '#options' => array (
                                                    '--' => '--',
                            'Лазером' => 'Лазером',
                            'Ручным способом' => 'Ручным способом',
                        ),
                    ),
                ),
                'atancion' => array (
                    '#value' => '<h4 style="color:red">Внимание! Демонтаж старого памятника, цветника, ограды в стоимость установки не входит.</h4>',
                ),
                'dop_work' => array (
                    '#type'  => 'textarea',
                    '#title' => 'Дополнительная работа',
                    '#rows'  => 4,
                ),
                'montag' => array (
                    '#type'    => 'radios',
                    '#title'   => 'Монтаж памятника',
                    '#options' => array (
                                            '--' => '--',
                        'Да, монтаж нужен' => 'Да, монтаж нужен',
                        'Нет, только доставка' => 'Нет, только доставка',
                        'Не нужен' => 'Не нужен',
                    ),
                    '#suffix'  => '<div class="clear"></div>',
                ),
            ),

            'submit_zakaz' => array (
                '#type'   => 'submit',
                '#value'  => 'Сделать заказ',
                '#submit' => array ('zakaz_submit'),
            ),
            
        ),
    );
}

function zakaz_submit(&$form, &$form_state) {
    global $conf;
    //$form_state['#files'] = $_FILES;


    $form_state['values']['zakaz_num'] = date('Hiz');

    $head = array (
       'to'      =>array($conf['site_mail'] =>'Ritual95'),
       'from'    =>array($form_state['values']['email'] => $form_state['values']['name']),
       /*'cc'      =>array($conf['site_mail'] =>'Admin'),
       'bcc'     =>array($conf['site_mail'] =>'Admin'),*/
    );

    $subj = 'Заказ №' .$form_state['values']['zakaz_num'];

    $body = theme('zakaz_mail_body', $form_state['values']);

    $files = array ();

    if ($_FILES && $_FILES['files']) {
        $files_dir = file_directory_path();
        $counter = 1;
        foreach ($_FILES['files']['error'] as $key => $error) {
            
            if (!$error) {
                $tmp_name = $_FILES['files']['tmp_name'][$key];
                $tmp_filepath = explode_filepath($tmp_name);

                $new_filepath = $tmp_filepath['path'] . $_FILES['files']['name'][$key];

                if (rename($tmp_name, $new_filepath)) {
                    $files[] = $new_filepath;
                    $form_state['values']['file' . $counter] = $_FILES['files']['name'][$key];
                } else $files[] = $tmp_name;
            }
        }
    }

    if (!mail::send($head, $subj, $body, $files)) {
        drupal_set_message('Не удалось отправить почтовое сообщение', 'error');
        return;
    }

    $head = array (
       'from'      =>array($conf['site_mail'] =>'Ritual95'),
       'to'    =>array($form_state['values']['email'] => $form_state['values']['name']),
       /*'cc'      =>array($conf['site_mail'] =>'Admin'),
       'bcc'     =>array($conf['site_mail'] =>'Admin'),*/
    );
    $body = '<b>Ваш заказ №'.$form_state['values']['zakaz_num'].'</b><br />'.theme('zakaz_mail_body', $form_state['values']);
    mail::send($head, $subj, $body, $files);
    
    drupal_set_message('Ваш заказ был отправлен на наш почтовый адрес.<br/>В ближайшее время наш сотрудник сважется с вами для подтверждения заказа и обсуждения его деталей.');
   
}

function zakaz_theme() {
    return array (
        'zakaz_mail_body' => array (
            'template'  => 'zakaz',
            'arguments' => array (
                'field' => NULL,
            ),
        ),
    );
}

function explode_filepath($filepath) {
    if (strrchr($filepath, '/')) $delimiter = '/';
    else $delimiter = "\\";

    $parts = explode($delimiter, $filepath);
    if (count($parts)) {
        $filename = array_pop($parts);
        $path = implode($delimiter, $parts);
        return array (
            'path' => $path . $delimiter,
            'file' => $filename,
        );
    } else return array (
        'path' => '',
        'file' => $filepath,
    );
}

function debug($data) {
    die('<pre>'.print_r($data, true).'</pre>');
}